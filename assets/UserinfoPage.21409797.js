import{u as V,r as $,i as x,o as g,j as p,w as d,U as f,S as _,d as l,t as i,e as n,f as Q,Z as P,m as c,l as m,k as U}from"./index.967effd4.js";import{Q as h}from"./QCard.ebb5154e.js";import{Q as C}from"./QFile.2752b4db.js";import{Q as j}from"./QForm.1a2f2305.js";import{Q as F}from"./QPage.00433689.js";const S={class:"container"},B={class:"text-h5 text-weight-bold q-ma-lg q-mt-xl text-center"},D={class:"info"},E={class:"image wrap col-md-2 col-xs-7 justify-center text-center items-center align-center q-mr-lg"},I=l("br",null,null,-1),A=l("br",null,null,-1),L={class:"wrap col-md-2 col-xs-6 q-ml-lg"},N=l("br",null,null,-1),M=l("br",null,null,-1),O=l("div",{class:"text-subtitle1 text-weight-bold"},"ID:",-1),Z={class:"text-subtitle1 text-center bg-white q-mb-md"},z={class:"text-subtitle1 text-weight-bold"},G={class:"text-subtitle1 text-center bg-white q-mb-md"},H={class:"text-subtitle1 text-weight-bold"},J={class:"text-subtitle1 text-center bg-white q-mb-md"},K={class:"text-subtitle1 text-weight-bold"},R={class:"text-subtitle1 text-center bg-white q-mb-md"},T={class:"q-my-xxl justify-center text-center items-center align-center"},W=l("div",{class:"text-subtitle1 text-weight-medium"},"ID:",-1),X={class:"text-subtitle1 text-weight-medium"},Y={class:"text-subtitle1 text-weight-medium"},ee={class:"text-subtitle1 text-weight-medium"},te={class:"text-subtitle1 text-weight-medium"},le={class:"q-my-xxl"},ue={__name:"UserinfoPage",setup(se){const v=V(),{logout:q}=v,r=$(!0),w=()=>{r.value?r.value=!1:r.value=!0},u=x({required(e){return!!e||"\u5FC5\u586B"}}),o=x({_id:"",account:"",email:"",name:"",image:null,idx:-1});console.log(o.name);const s=x({_id:"",account:"",email:"",name:"",image:null,submitting:!1,idx:-1}),y=()=>{r.value=!1,s._id=o._id,s.name=o.name,s.account=o.account,s.email=o.email,s.image=null},b=async()=>{try{const{data:e}=await f.get("/users");o._id=e.result._id,o.account=e.result.account,o.email=e.result.email,o.name=e.result.name,o.image=e.result.image}catch(e){console.log(e),_.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};b();const k=async()=>{console.log(s);const e=new FormData;for(const t in s)t==="image"&&s.avatar===null||e.append(t,s[t]);try{const{data:t}=await f.patch("/users",e);_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),b(),r.value=!0}catch(t){_.fire({icon:"error",title:"\u7DE8\u8F2F\u5931\u6557",text:t.isAxiosError?t.response.data.message:t.message})}};return b(),(e,t)=>(g(),p(F,null,{default:d(()=>[l("section",S,[l("div",B,i(e.$t("Personal")),1),l("div",D,[r.value?(g(),p(h,{key:0,flat:"",class:"q-pa-md row bg-blue-2 justify-center text-start align-center",style:{height:"fit-content"}},{default:d(()=>[l("div",E,[I,n(Q,{src:o.image,style:{"border-radius":"50%",border:"5px solid white"}},null,8,["src"]),A]),l("div",L,[N,M,O,l("div",Z,i(o._id),1),l("div",z,i(e.$t("Paccount"))+":",1),l("div",G,i(o.account),1),l("div",H,i(e.$t("Pname"))+":",1),l("div",J,i(o.name),1),l("div",K,i(e.$t("Pemail"))+":",1),l("div",R,i(o.email),1),l("div",T,[n(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",label:e.$t("Logout"),color:"black",onClick:P(q),to:"/Login"},null,8,["label","onClick"]),n(c,{label:e.$t("Edit"),class:"q-py-sm q-px-xxl text-subtitle2",unelevated:"",color:"primary",onClick:t[0]||(t[0]=a=>y())},null,8,["label"])])])]),_:1})):(g(),p(h,{key:1,flat:"",class:"q-pa-md flex items-center justify-center text-center"},{default:d(()=>[n(j,{onSubmit:t[7]||(t[7]=U(a=>k(),["prevent"]))},{default:d(()=>[W,n(m,{modelValue:s._id,"onUpdate:modelValue":t[1]||(t[1]=a=>s._id=a),readonly:"",rules:[u.required],color:"black"},null,8,["modelValue","rules"]),l("div",X,i(e.$t("Paccount"))+":",1),n(m,{modelValue:s.account,"onUpdate:modelValue":t[2]||(t[2]=a=>s.account=a),readonly:"",rules:[u.required],color:"black"},null,8,["modelValue","rules"]),l("div",Y,i(e.$t("Pname"))+":",1),n(m,{modelValue:s.name,"onUpdate:modelValue":t[3]||(t[3]=a=>s.name=a),rules:[u.required],color:"black"},null,8,["modelValue","rules"]),l("div",ee,i(e.$t("Pemail"))+":",1),n(m,{modelValue:s.email,"onUpdate:modelValue":t[4]||(t[4]=a=>s.email=a),rules:[u.required],color:"black"},null,8,["modelValue","rules"]),l("div",te,i(e.$t("Pimage"))+":",1),n(C,{modelValue:s.image,"onUpdate:modelValue":t[5]||(t[5]=a=>s.image=a),standout:"",counter:"",label:e.$t("\u5716\u7247")},null,8,["modelValue","label"]),l("div",le,[n(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:e.$t("Cancel"),onClick:t[6]||(t[6]=a=>w())},null,8,["label"]),n(c,{type:"submit",unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",color:"black",label:e.$t("Ok")},null,8,["label"])])]),_:1})]),_:1}))])])]),_:1}))}};export{ue as default};
