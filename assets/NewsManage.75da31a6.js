import{h as I,r as V,O as E,o as m,i as u,w as s,P as v,S as c,g as n,d as l,l as r,j as z,k as p,U as f,R as C,W as L,X as x,Y as D,Z as P,$ as j,a as M,a1 as O,a7 as R,a2 as N,a3 as W,a4 as X,a5 as Y,a6 as Z,a0 as G,a8 as g}from"./index.20169eab.js";import{Q as H}from"./QFile.cbe263b9.js";import{Q as U}from"./QToggle.6d6012b2.js";import{Q as y}from"./QCard.9a819d27.js";import{Q as J}from"./QForm.20a64a91.js";import{a as A,b as K,Q as ee}from"./QTable.5e7892f8.js";import{Q as $}from"./QCardSection.d66a42a3.js";import{Q as B}from"./QCardActions.f709d361.js";import{Q as le}from"./QSeparator.8499541a.js";import{Q as te}from"./QPage.32325f25.js";import"./use-checkbox.39271d9d.js";const ae={class:"row bg-primary",style:{height:"100px"}},oe={class:"row"},se={flat:"",class:"col",col:"10"},ie={class:"col",col:"6"},ne={class:"row"},de={class:"col",col:"10"},re={class:"row"},me={class:"col",col:"6"},ue={class:"col",col:"6"},ce={class:"row"},pe={class:"col",col:"12"},fe={class:"row"},ge={class:"col",col:"6"},ye={class:"q-pa-md"},be=["src"],Ve={class:"q-ml-sm text-center q-ml-md"},ve=["src"],xe={class:"flex",style:{"justify-content":"space-around"}},_e={class:"q-ml-sm text-center q-ml-md"},Ae={__name:"NewsManage",setup(we){const d=I([]),_=V(""),q=V([]),w=V(!1),h=V(!1),F=[{name:"image",label:"Image"},{name:"name",required:!0,label:"Name",field:o=>o.name,sortable:!0},{name:"title",label:"Title",field:o=>o.title,sortable:!0},{name:"startDay",field:o=>o.startDay,label:"Start Day",sortable:!0},{name:"edit",label:"Edit"}],t=I({_id:"",name:"",sell:!1,image:null,description:"",title:"",idx:-1,dialog:!1,valid:!1,submitting:!1,startDay:"",endDay:""}),Q=o=>{t._id=o;const e=o===""?-1:d.findIndex(b=>b._id===o);e>-1?(t.name=d[e].name,t.sell=d[e].sell,t.description=d[e].description,t.title=d[e].title,t.startDay=d[e].startDay,t.endDay=d[e].endDay):(t.name="",t.sell=!1,t.description="",t.startDay="",t.endDay="",t.title=""),t.image=null,t.idx=e,t.dialog=!0,t.valid=!1,t.submitting=!1},T=async()=>{t.submitting=!0;const o=new FormData;for(const e in t)["_id","idx","dialog","valid","submitting"].includes(e)||o.append(e,t[e]);console.log(o);try{if(t._id.length===0){const{data:e}=await v.post("/info/",o);d.push(e.result),c.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await v.patch("/info/"+t._id,o);console.log("1234"),d[t.idx]=e.result,c.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),k()}t.dialog=!1}catch(e){c.fire({icon:"success",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}t.submitting=!1},S=async o=>{try{await v.delete("/info/"+o),await c.fire({icon:"success",title:"\u6210\u529F",text:"\u6D3B\u52D5\u522A\u9664\u6210\u529F"}),k()}catch{c.fire({icon:"error",title:"\u6D3B\u52D5\u522A\u9664\u5931\u6557",text:"\u6D3B\u52D5\u522A\u9664\u5931\u6557"})}},k=async()=>{try{const{data:o}=await v.get("/info/all");d.splice(0,d.length),d.push(...o.result)}catch(o){console.log(o),c.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return console.log(d),k(),(o,e)=>{const b=E("q-card-action");return m(),u(te,{id:"adminItinerary"},{default:s(()=>[n("div",ae,[l(r,{flat:"",fab:"",color:"dark",icon:"mdi-plus",style:{width:"70px",height:"70px","margin-top":"15px","border-radius":"50%"},onClick:e[0]||(e[0]=a=>Q(""))}),l(C,{seamless:"",modelValue:t.dialog,"onUpdate:modelValue":e[8]||(e[8]=a=>t.dialog=a),persistent:""},{default:s(()=>[l(y,{id:"dialog"},{default:s(()=>[l(J,{modelValue:t.valid,"onUpdate:modelValue":e[7]||(e[7]=a=>t.valid=a),onSubmit:z(T,["prevent"])},{default:s(()=>[l(y,{flat:""},{default:s(()=>[n("div",oe,[n("div",se,[l(p,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.name=a),label:o.$t("\u767C\u6587\u8005"),class:"q-ma-md"},null,8,["modelValue","label"])]),n("div",ie,[l(p,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.startDay,"onUpdate:modelValue":e[2]||(e[2]=a=>t.startDay=a),label:o.$t("\u516C\u544A\u65E5\u671F"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),n("div",ne,[n("div",de,[l(p,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.title,"onUpdate:modelValue":e[3]||(e[3]=a=>t.title=a),label:o.$t("\u6700\u65B0\u516C\u544A\u6A19\u984C"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),n("div",re,[n("div",me,[n("div",ue,[l(H,{modelValue:t.image,"onUpdate:modelValue":e[4]||(e[4]=a=>t.image=a),rounded:"",standout:"",counter:"",label:o.$t("\u516C\u544A\u5716\u7247")},null,8,["modelValue","label"])])])]),n("div",ce,[n("div",pe,[l(p,{modelValue:t.description,"onUpdate:modelValue":e[5]||(e[5]=a=>t.description=a),rounded:"",standout:"",label:"\u516C\u544A\u5167\u5BB9",autogrow:"",type:"textarea"},null,8,["modelValue"])])]),n("div",fe,[n("div",ge,[l(U,{"false-value":!1,label:`On the Shelf - ${t.sell}`,"true-value":!0,color:"green","toggle-indeterminate":"false",modelValue:t.sell,"onUpdate:modelValue":e[6]||(e[6]=a=>t.sell=a)},null,8,["label","modelValue"])])]),l(b,{class:"text-center"},{default:s(()=>[f(l(r,{type:"sumbit",label:o.$t("submit"),color:"primary",loading:t.submitting},null,8,["label","loading"]),[[g]])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),n("div",ye,[l(ee,{grid:o.$q.screen.lt.md,title:o.$t("\u6700\u65B0\u516C\u544A"),rows:d,columns:F,"row-key":"name",filter:_.value,selection:"multiple",selected:q.value,"onUpdate:selected":e[14]||(e[14]=a=>q.value=a)},{"top-right":s(()=>[l(p,{borderless:"",dense:"",debounce:"300",modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=a=>_.value=a),placeholder:"Search"},{append:s(()=>[l(L,{name:"search"})]),_:1},8,["modelValue"])]),"header-selection":s(a=>[(m(),u(U,{modelValue:a.selected,"onUpdate:modelValue":i=>a.selected=i,key:d.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-selection":s(a=>[(m(),u(U,{modelValue:a.selected,"onUpdate:modelValue":i=>a.selected=i,key:d.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-cell-image":s(a=>[l(A,{style:{"text-align":"right"}},{default:s(()=>[l(x,null,{default:s(()=>[n("img",{src:a.row.image,alt:""},null,8,be)]),_:2},1024)]),_:2},1024)]),"body-cell-edit":s(a=>[l(A,{style:{"text-align":"right"}},{default:s(()=>[l(r,{round:"",class:"bg-accent",style:{width:"50px",height:"50px"},onClick:i=>Q(a.row._id),icon:"mdi-circle-edit-outline"},null,8,["onClick"]),l(r,{round:"",class:"bg-red",style:{width:"50px",height:"50px"},onClick:e[10]||(e[10]=i=>w.value=!0),icon:"mdi-delete"})]),_:2},1024),l(C,{modelValue:w.value,"onUpdate:modelValue":e[11]||(e[11]=i=>w.value=i),persistent:""},{default:s(()=>[l(y,null,{default:s(()=>[l($,{class:"row items-center"},{default:s(()=>[l(x,{icon:"mdi-account-arrow-right",color:"primary","text-color":"white"}),n("span",Ve,D(o.$t("Delete"))+" ?",1)]),_:1}),l(B,{align:"right"},{default:s(()=>[f(l(r,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:i=>S(a.row._id)},null,8,["onClick"]),[[g]]),f(l(r,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[g]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),item:s(a=>[n("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:P(a.selected?"transform: scale(0.95);":"")},[l(y,{class:j(a.selected?"bg-grey-2":"")},{default:s(()=>[l($,null,{default:s(()=>[l(K,{dense:"",modelValue:a.selected,"onUpdate:modelValue":i=>a.selected=i,label:a.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),l(le),(m(!0),M(G,null,O(a.cols,i=>(m(),u(R,{key:i.name},{default:s(()=>[l(N,{class:"text-center"},{default:s(()=>[l(W,{class:"text-center q-mx-auto"},{default:s(()=>[l(N,null,{default:s(()=>[i.name!=="image"?(m(),u(X,{key:0,caption:"",class:"text-center q-mx-auto"},{default:s(()=>[Y(D(i.value),1)]),_:2},1024)):i.name=="image"?(m(),u(x,{key:1,square:"",size:"200px",class:"text-center q-mx-auto"},{default:s(()=>[n("img",{src:a.row[i.name],alt:""},null,8,ve)]),_:2},1024)):Z("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),l(b,{class:"q-mx-auto text-center"},{default:s(()=>[n("div",xe,[l(r,{rounded:"",class:"text-center bg-red",onClick:e[12]||(e[12]=i=>h.value=!0),icon:"mdi-delete",style:{width:"50px",height:"50px"}}),l(r,{rounded:"",class:"text-center bg-accent",onClick:i=>Q(a.row._id),icon:"mdi-circle-edit-outline",style:{width:"50px",height:"50px"}},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]),l(C,{modelValue:h.value,"onUpdate:modelValue":e[13]||(e[13]=i=>h.value=i),persistent:""},{default:s(()=>[l(y,null,{default:s(()=>[l($,{class:"row items-center"},{default:s(()=>[l(x,{icon:"mdi-account-arrow-right",color:"primary","text-color":"white"}),n("span",_e,D(o.$t("Delete"))+" ?",1)]),_:1}),l(B,{align:"right"},{default:s(()=>[f(l(r,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:i=>S(a.row._id)},null,8,["onClick"]),[[g]]),f(l(r,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[g]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])],4)]),_:1},8,["grid","title","rows","filter","selected"])])]),_:1})}}};export{Ae as default};
