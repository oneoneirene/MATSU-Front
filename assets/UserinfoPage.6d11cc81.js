import{u as V,r as Q,i as b,o as _,j as g,w as u,T as f,S as p,d as t,e as a,f as U,Y as d,Z as C,m as c,l as m,k as j}from"./index.85b15680.js";import{Q as h}from"./QCard.301a3c4b.js";import{Q as F}from"./QFile.67e5ce8a.js";import{Q as S}from"./QForm.f384b61e.js";import{Q as B}from"./QPage.7d376a4d.js";const D={class:"container"},I=t("div",{class:"text-h5 text-weight-bold q-ma-lg q-mt-xl text-center"},"\u500B\u4EBA\u8CC7\u8A0A\u7BA1\u7406",-1),$={class:"info"},A={class:"image wrap col-md-2 col-xs-7 justify-center text-center items-center align-center q-mr-lg"},E=t("br",null,null,-1),N=t("br",null,null,-1),P={class:"wrap col-md-2 col-xs-6 q-ml-lg"},L=t("br",null,null,-1),M=t("br",null,null,-1),T=t("div",{class:"text-subtitle1 text-weight-bold"},"ID:",-1),Y={class:"text-subtitle1 text-center bg-white q-mb-md"},Z=t("div",{class:"text-subtitle1 text-weight-bold"},"\u5E33\u865F:",-1),z={class:"text-subtitle1 text-center bg-white q-mb-md"},G=t("div",{class:"text-subtitle1 text-weight-bold"},"\u66B1\u7A31:",-1),H={class:"text-subtitle1 text-center bg-white q-mb-md"},J=t("div",{class:"text-subtitle1 text-weight-bold"},"\u96FB\u5B50\u90F5\u4EF6\u4FE1\u7BB1:",-1),K={class:"text-subtitle1 text-center bg-white q-mb-md"},O={class:"q-my-xxl justify-center text-center items-center align-center"},R=t("div",{class:"text-subtitle1 text-weight-medium"},"ID:",-1),W=t("div",{class:"text-subtitle1 text-weight-medium"},"\u5E33\u865F:",-1),X=t("div",{class:"text-subtitle1 text-weight-medium"},"\u66B1\u7A31:",-1),ee=t("div",{class:"text-subtitle1 text-weight-medium"},"\u96FB\u5B50\u90F5\u4EF6\u4FE1\u7BB1:",-1),te=t("div",{class:"text-subtitle1 text-weight-medium"},"\u5716\u7247\u4E0A\u50B3:",-1),le={class:"q-my-xxl"},ue={__name:"UserinfoPage",setup(se){const v=V(),{logout:q}=v,n=Q(!0),w=()=>{n.value?n.value=!1:n.value=!0},r=b({required(s){return!!s||"\u5FC5\u586B"}}),o=b({_id:"",account:"",email:"",name:"",image:null,idx:-1});console.log(o.name);const l=b({_id:"",account:"",email:"",name:"",image:null,submitting:!1,idx:-1}),y=()=>{n.value=!1,l._id=o._id,l.name=o.name,l.account=o.account,l.email=o.email,l.image=null},x=async()=>{try{const{data:s}=await f.get("/users");o._id=s.result._id,o.account=s.result.account,o.email=s.result.email,o.name=s.result.name,o.image=s.result.image}catch(s){console.log(s),p.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}};x();const k=async()=>{console.log(l);const s=new FormData;for(const e in l)e==="image"&&l.avatar===null||s.append(e,l[e]);try{const{data:e}=await f.patch("/users",s);p.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),x(),n.value=!0}catch(e){p.fire({icon:"error",title:"\u7DE8\u8F2F\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};return x(),(s,e)=>(_(),g(B,null,{default:u(()=>[t("section",D,[I,t("div",$,[n.value?(_(),g(h,{key:0,flat:"",class:"q-pa-md row bg-blue-2 justify-center text-start align-center",style:{height:"fit-content"}},{default:u(()=>[t("div",A,[E,a(U,{src:o.image,style:{"border-radius":"50%",border:"5px solid white"}},null,8,["src"]),N]),t("div",P,[L,M,T,t("div",Y,d(o._id),1),Z,t("div",z,d(o.account),1),G,t("div",H,d(o.name),1),J,t("div",K,d(o.email),1),t("div",O,[a(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",label:"\u767B\u51FA",color:"black",onClick:C(q),to:"/Login"},null,8,["onClick"]),a(c,{label:"\u4FEE\u6539",class:"q-py-sm q-px-xxl text-subtitle2",unelevated:"",color:"primary",onClick:e[0]||(e[0]=i=>y())})])])]),_:1})):(_(),g(h,{key:1,flat:"",class:"q-pa-md flex items-center justify-center text-center"},{default:u(()=>[a(S,{onSubmit:e[7]||(e[7]=j(i=>k(),["prevent"]))},{default:u(()=>[R,a(m,{modelValue:l._id,"onUpdate:modelValue":e[1]||(e[1]=i=>l._id=i),readonly:"",rules:[r.required],color:"black"},null,8,["modelValue","rules"]),W,a(m,{modelValue:l.account,"onUpdate:modelValue":e[2]||(e[2]=i=>l.account=i),readonly:"",rules:[r.required],color:"black"},null,8,["modelValue","rules"]),X,a(m,{modelValue:l.name,"onUpdate:modelValue":e[3]||(e[3]=i=>l.name=i),rules:[r.required],color:"black"},null,8,["modelValue","rules"]),ee,a(m,{modelValue:l.email,"onUpdate:modelValue":e[4]||(e[4]=i=>l.email=i),rules:[r.required],color:"black"},null,8,["modelValue","rules"]),te,a(F,{modelValue:l.image,"onUpdate:modelValue":e[5]||(e[5]=i=>l.image=i),standout:"",counter:"",label:s.$t("\u5716\u7247")},null,8,["modelValue","label"]),t("div",le,[a(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:e[6]||(e[6]=i=>w())}),a(c,{type:"submit",unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",color:"black",label:"\u78BA\u5B9A"})])]),_:1})]),_:1}))])])]),_:1}))}};export{ue as default};
