import{Q}from"./QSpace.7a78b6f7.js";import{u as U,r as C,i as b,o as g,j as _,w as d,T as f,S as p,d as s,e as a,f as v,Y as u,Z as S,m as c,l as m,k as F}from"./index.de7da131.js";import{Q as q}from"./QCard.40289e02.js";import{Q as j}from"./QFile.7ef7f8e4.js";import{Q as B}from"./QForm.14d20536.js";import{Q as D}from"./QPage.1243c3c6.js";const I={class:"container"},$={class:"row q-mt-none q-mt-lg-xl justify-center text-center align-center"},A={class:"col-12 col-lg-4"},E={class:"flex items-center justify-center text-center q-mb-lg q-mt-lg q-mt-lg-none"},N=s("div",{class:"text-body1 q-mb-md"},"\u500B\u4EBA\u8CC7\u8A0A\u9801\u9762",-1),P=s("div",{class:"text-subtitle1 text-weight-bold"},"ID:",-1),L={class:"text-subtitle1 q-mb-md"},M=s("div",{class:"text-subtitle1 text-weight-bold"},"\u5E33\u865F:",-1),T={class:"text-subtitle1 q-mb-md"},Y=s("div",{class:"text-subtitle1 text-weight-bold"},"\u66B1\u7A31:",-1),Z={class:"text-subtitle1 q-mb-md"},z=s("div",{class:"text-subtitle1 text-weight-bold"},"\u96FB\u5B50\u90F5\u4EF6\u4FE1\u7BB1:",-1),G={class:"text-subtitle1 q-mb-md"},H={class:"q-my-xxl"},J=s("div",{class:"text-subtitle1 text-weight-medium"},"ID:",-1),K=s("div",{class:"text-subtitle1 text-weight-medium"},"\u5E33\u865F:",-1),O=s("div",{class:"text-subtitle1 text-weight-medium"},"\u66B1\u7A31:",-1),R=s("div",{class:"text-subtitle1 text-weight-medium"},"\u96FB\u5B50\u90F5\u4EF6\u4FE1\u7BB1:",-1),W=s("div",{class:"text-subtitle1 text-weight-medium"},"\u7167\u7247\u4E0A\u50B3:",-1),X={class:"q-my-xxl"},ne={__name:"UserinfoPage",setup(ee){const h=U(),{logout:y}=h,n=C(!0),k=()=>{n.value?n.value=!1:n.value=!0},r=b({required(l){return!!l||"\u5FC5\u586B"}}),o=b({_id:"",account:"",email:"",name:"",image:null,idx:-1});console.log(o.name);const t=b({_id:"",account:"",email:"",name:"",image:null,submitting:!1,idx:-1}),w=()=>{n.value=!1,t._id=o._id,t.name=o.name,t.account=o.account,t.email=o.email,t.image=null},x=async()=>{try{const{data:l}=await f.get("/users");o._id=l.result._id,o.account=l.result.account,o.email=l.result.email,o.name=l.result.name,o.image=l.result.image}catch(l){console.log(l),p.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}};x();const V=async()=>{console.log(t);const l=new FormData;for(const e in t)e==="image"&&t.avatar===null||l.append(e,t[e]);try{const{data:e}=await f.patch("/users",l);p.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),x(),n.value=!0}catch(e){p.fire({icon:"error",title:"\u7DE8\u8F2F\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};return x(),(l,e)=>(g(),_(D,null,{default:d(()=>[s("section",I,[s("div",$,[s("div",A,[s("div",E,[a(Q)]),N,n.value?(g(),_(q,{key:0,flat:"",bordered:"",class:"q-pa-md"},{default:d(()=>[a(v,{src:o.image},null,8,["src"]),P,s("div",L,u(o._id),1),M,s("div",T,u(o.account),1),Y,s("div",Z,u(o.name),1),z,s("div",G,u(o.email),1),s("div",H,[a(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",label:"\u767B\u51FA",color:"black",onClick:S(y),to:"/Login"},null,8,["onClick"]),a(c,{label:"\u4FEE\u6539",class:"q-py-sm q-px-xxl text-subtitle2",unelevated:"",color:"black",onClick:e[0]||(e[0]=i=>w())})])]),_:1})):(g(),_(q,{key:1,flat:"",bordered:"",class:"q-pa-md flex items-center justify-center text-center"},{default:d(()=>[a(B,{onSubmit:e[7]||(e[7]=F(i=>V(),["prevent"]))},{default:d(()=>[a(v,{src:t.image},null,8,["src"]),J,a(m,{modelValue:t._id,"onUpdate:modelValue":e[1]||(e[1]=i=>t._id=i),readonly:"",rules:[r.required],color:"black"},null,8,["modelValue","rules"]),K,a(m,{modelValue:t.account,"onUpdate:modelValue":e[2]||(e[2]=i=>t.account=i),readonly:"",rules:[r.required],color:"black"},null,8,["modelValue","rules"]),O,a(m,{modelValue:t.name,"onUpdate:modelValue":e[3]||(e[3]=i=>t.name=i),rules:[r.required],color:"black"},null,8,["modelValue","rules"]),R,a(m,{modelValue:t.email,"onUpdate:modelValue":e[4]||(e[4]=i=>t.email=i),rules:[r.required],color:"black"},null,8,["modelValue","rules"]),W,a(j,{modelValue:t.image,"onUpdate:modelValue":e[5]||(e[5]=i=>t.image=i),standout:"",counter:"",label:l.$t("\u5716\u7247")},null,8,["modelValue","label"]),s("div",X,[a(c,{outline:"",class:"q-py-sm q-px-xxl text-subtitle2 q-mr-md",color:"black",label:"\u53D6\u6D88",onClick:e[6]||(e[6]=i=>k())}),a(c,{type:"submit",unelevated:"",class:"q-py-sm q-px-xxl text-subtitle2",color:"black",label:"\u78BA\u5B9A"})])]),_:1})]),_:1}))])])])]),_:1}))}};export{ne as default};
